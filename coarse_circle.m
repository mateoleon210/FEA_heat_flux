%% initializing code
function[n_mat, c_mat, counter, x] =coarse_circle
x= -5;
old_n_mat=[	-5.,	-5	;	
		15.,	-5	;	
		15.,	5	;	
		-5.,	5	;	
		4.16750002,	-3.60750008	;	
		2.5,	0	;	
		-3.66666675,	-5	;	
		-2.33333325,	-5	;	
		-1.,	-5	;	
		0.333333343,	-5	;	
		1.66666663,	-5	;	
		3.,	-5	;	
		4.33333349,	-5	;	
		5.66666651,	-5	;	
		7.,	-5	;	
		8.33333302,	-5	;	
		9.66666698,	-5	;	
		11.,	-5	;	
		12.333333,	-5	;	
		13.666667,	-5	;	
		15.,	-4	;	
		15.,	-3	;	
		15.,	-2	;	
		15.,	-1	;	
		15.,	0	;	
		15.,	1	;	
		15.,	2	;	
		15.,	3	;	
		15.,	4	;	
		13.666667,	5	;	
		12.333333,	5	;	
		11.,	5	;	
		9.66666698,	5	;	
		8.33333302,	5	;	
		7.,	5	;	
		5.66666651,	5	;	
		4.33333349,	5	;	
		3.,	5	;	
		1.66666663,	5	;	
		0.333333343,	5	;	
		-1.,	5	;	
		-2.33333325,	5	;	
		-3.66666675,	5	;	
		-5.,	4	;	
		-5.,	3	;	
		-5.,	2	;	
		-5.,	1	;	
		-5.,	0	;	
		-5.,	-1	;	
		-5.,	-2	;	
		-5.,	-3	;	
		-5.,	-4	;	
		4.58415031,	-3.67888331	;	
		5.00622225,	-3.70230651	;	
		5.42821264,	-3.67746472	;	
		5.8446207,	-3.60468149	;	
		6.25001812,	-3.48490548	;	
		6.63911963,	-3.31969881	;	
		7.00685263,	-3.1112144	;	
		7.348423,	-2.86217093	;	
		7.65937805,	-2.57581449	;	
		7.93566465,	-2.25587821	;	
		8.17367935,	-1.90653336	;	
		8.37032127,	-1.53233385	;	
		8.52302551,	-1.13815796	;	
		8.62980175,	-0.729144573	;	
		8.68925762,	-0.310625583	;	
		8.70061874,	0.111942887	;	
		8.6637373,	0.533051968	;	
		8.57909203,	0.947211981	;	
		8.44778919,	1.34902358	;	
		8.27153778,	1.73324859	;	
		8.05263805,	2.09487796	;	
		7.79394197,	2.42919755	;	
		7.49882269,	2.73184872	;	
		7.17112732,	2.99888611	;	
		6.81512833,	3.22682858	;	
		6.43546581,	3.41270423	;	
		6.0370903,	3.55409002	;	
		5.62519455,	3.64914298	;	
		5.20514822,	3.6966238	;	
		4.78242779,	3.69591331	;	
		4.36254358,	3.64702106	;	
		3.9509697,	3.55058408	;	
		3.55307126,	3.40786004	;	
		3.17403603,	3.22070932	;	
		2.81880498,	2.99157166	;	
		2.49200916,	2.72343421	;	
		2.19790864,	2.41979289	;	
		1.9403379,	2.08460569	;	
		1.72265446,	1.72224236	;	
		1.54769623,	1.33742714	;	
		1.41774404,	0.935176432	;	
		1.33449209,	0.52073431	;	
		1.29902565,	0.099503622	;	
		1.31180692,	-0.323024243	;	
		1.37266958,	-0.741340995	;	
		1.48081994,	-1.1499933	;	
		1.63484824,	-1.54365361	;	
		1.83274651,	-1.91719007	;	
		2.0719347,	-2.265733	;	
		2.34929466,	-2.58473873	;	
		2.66121078,	-2.87004828	;	
		3.00361633,	-3.11794233	;	
		3.3720479,	-3.32518935	;	
		3.76170254,	-3.48908758	;	
		2.50342607,	-0.130839884	;	
		2.51369524,	-0.261321157	;	
		2.53077912,	-0.391086161	;	
		2.55463099,	-0.519779205	;	
		2.58518553,	-0.647047639	;	
		2.6223588,	-0.772542477	;	
		2.666049,	-0.895919859	;	
		2.71613646,	-1.01684165	;	
		2.77248359,	-1.13497627	;	
		2.83493638,	-1.25	;	
		2.90332365,	-1.36159754	;	
		2.97745752,	-1.46946311	;	
		3.05713511,	-1.57330096	;	
		3.142138,	-1.67282653	;	
		3.23223305,	-1.76776695	;	
		3.32717347,	-1.85786211	;	
		3.42669892,	-1.94286489	;	
		3.53053689,	-2.02254248	;	
		3.63840246,	-2.09667635	;	
		3.75,	-2.16506362	;	
		3.86502385,	-2.22751641	;	
		3.98315835,	-2.28386354	;	
		4.1040802,	-2.333951	;	
		4.22745752,	-2.3776412	;	
		4.35295248,	-2.41481447	;	
		4.48022079,	-2.44536901	;	
		4.6089139,	-2.46922088	;	
		4.73867893,	-2.48630476	;	
		4.86916018,	-2.49657393	;	
		5.,	-2.5	;	
		5.13083982,	-2.49657393	;	
		5.26132107,	-2.48630476	;	
		5.3910861,	-2.46922088	;	
		5.51977921,	-2.44536901	;	
		5.64704752,	-2.41481447	;	
		5.77254248,	-2.3776412	;	
		5.8959198,	-2.333951	;	
		6.01684141,	-2.28386354	;	
		6.13497639,	-2.22751641	;	
		6.25,	-2.16506362	;	
		6.36159754,	-2.09667635	;	
		6.46946335,	-2.02254248	;	
		6.57330084,	-1.94286489	;	
		6.67282629,	-1.85786211	;	
		6.76776695,	-1.76776695	;	
		6.857862,	-1.67282653	;	
		6.94286489,	-1.57330096	;	
		7.02254248,	-1.46946311	;	
		7.09667635,	-1.36159754	;	
		7.16506338,	-1.25	;	
		7.22751617,	-1.13497627	;	
		7.28386354,	-1.01684165	;	
		7.333951,	-0.895919859	;	
		7.3776412,	-0.772542477	;	
		7.41481447,	-0.647047639	;	
		7.44536877,	-0.519779205	;	
		7.46922064,	-0.391086161	;	
		7.48630476,	-0.261321157	;	
		7.49657393,	-0.130839884	;	
		7.5,	0	;	
		7.49657393,	0.130839884	;	
		7.48630476,	0.261321157	;	
		7.46922064,	0.391086161	;	
		7.44536877,	0.519779205	;	
		7.41481447,	0.647047639	;	
		7.3776412,	0.772542477	;	
		7.333951,	0.895919859	;	
		7.28386354,	1.01684165	;	
		7.22751617,	1.13497627	;	
		7.16506338,	1.25	;	
		7.09667635,	1.36159754	;	
		7.02254248,	1.46946311	;	
		6.94286489,	1.57330096	;	
		6.857862,	1.67282653	;	
		6.76776695,	1.76776695	;	
		6.67282629,	1.85786211	;	
		6.57330084,	1.94286489	;	
		6.46946335,	2.02254248	;	
		6.36159754,	2.09667635	;	
		6.25,	2.16506362	;	
		6.13497639,	2.22751641	;	
		6.01684141,	2.28386354	;	
		5.8959198,	2.333951	;	
		5.77254248,	2.3776412	;	
		5.64704752,	2.41481447	;	
		5.51977921,	2.44536901	;	
		5.3910861,	2.46922088	;	
		5.26132107,	2.48630476	;	
		5.13083982,	2.49657393	;	
		5.,	2.5	;	
		4.86916018,	2.49657393	;	
		4.73867893,	2.48630476	;	
		4.6089139,	2.46922088	;	
		4.48022079,	2.44536901	;	
		4.35295248,	2.41481447	;	
		4.22745752,	2.3776412	;	
		4.1040802,	2.333951	;	
		3.98315835,	2.28386354	;	
		3.86502385,	2.22751641	;	
		3.75,	2.16506362	;	
		3.63840246,	2.09667635	;	
		3.53053689,	2.02254248	;	
		3.42669892,	1.94286489	;	
		3.32717347,	1.85786211	;	
		3.23223305,	1.76776695	;	
		3.142138,	1.67282653	;	
		3.05713511,	1.57330096	;	
		2.97745752,	1.46946311	;	
		2.90332365,	1.36159754	;	
		2.83493638,	1.25	;	
		2.77248359,	1.13497627	;	
		2.71613646,	1.01684165	;	
		2.666049,	0.895919859	;	
		2.6223588,	0.772542477	;	
		2.58518553,	0.647047639	;	
		2.55463099,	0.519779205	;	
		2.53077912,	0.391086161	;	
		2.51369524,	0.261321157	;	
		2.50342607,	0.130839884	;	
		4.37901449,	-4.07121134	;	
		3.49613309,	-3.86853838	;	
		4.25435448,	4.07178593	;	
		5.27509785,	-4.16252851	;	
		3.49217558,	3.93059707	;	
		5.76489925,	4.11099625	;	
		6.26852274,	-4.0806098	;	
		6.56464005,	3.64199829	;	
		2.26512933,	2.84278131	;	
		2.49631071,	-3.85340452	;	
		7.90697384,	3.17271471	;	
		6.38531923,	4.17344189	;	
		9.42349815,	0.040856235	;	
		7.96315765,	-3.44246221	;	
		2.764328,	3.75493288	;	
		8.43085194,	2.33633232	;	
		7.20183086,	-3.99233079	;	
		8.69438839,	-1.92479789	;	
		0.672789514,	0.65663588	;	
		1.98499262,	-3.19654775	;	
		0.741620958,	-0.933165312	;	
		1.15677464,	-1.72786558	;	
		1.66092026,	2.78368902	;	
		8.46519947,	-2.5783596	;	
		9.16281128,	-1.33215451	;	
		2.15600371,	3.29541874	;	
		0.915888608,	1.40280986	;	
		0.629843831,	-0.13640587	;	
		1.50137198,	-2.54839778	;	
		1.22323251,	2.11765909	;	
		9.32095528,	0.988161743	;	
		5.09028912,	4.17492342	;	
		8.82984829,	1.61598814	;	
		9.60340405,	-0.690604925	;	
		0.310699821,	-1.69150317	;	
		0.192510068,	1.37409747	;	
		0.43808192,	1.99301279	;	
		9.24830246,	-2.27264643	;	
		0.579584181,	2.58439064	;	
		0.622348905,	-2.35516477	;	
		9.16942978,	-2.9466114	;	
		0.800487161,	-2.99531507	;	
		8.82627583,	3.09359789	;	
		1.03077698,	3.02188659	;	
		8.78389263,	-3.34248662	;	
		1.26303983,	-3.43001771	;	
		8.41691875,	3.87481093	;	
		1.55410492,	3.4318645	;	
		9.2052927,	2.31455469	;	
		9.47592449,	1.703125	;	
		10.1085844,	-1.12061918	;	
		-0.232585028,	0.87426585	;	
		-0.112253912,	0.199102998	;	
		10.2778082,	0.117075488	;	
		10.1079426,	0.699461401	;	
		-0.16965574,	-1.19559002	;	
		10.1707239,	-0.437247217	;	
		-0.0850165114,	-0.512956262	;	
		0.290431112,	3.23444223	;	
		-0.038244497,	2.56223536	;	
		9.44105148,	-3.67855358	;	
		-0.12202508,	-2.27865553	;	
		0.546470523,	-3.73841357	;	
		10.1017675,	-1.99978733	;	
		-0.239124134,	1.92268264	;	
		9.82416153,	-2.91688633	;	
		0.144326612,	-3.00805783	;	
		9.18824387,	3.97083974	;	
		1.69963241,	-3.93752146	;	
		2.01274776,	4.07656336	;	
		7.76568222,	4.17764473	;	
		10.0420399,	1.44321418	;	
		-0.826938927,	-1.46358788	;	
		10.7932034,	0.46848011	;	
		10.7969389,	-1.49345398	;	
		-0.829004467,	0.493819743	;	
		10.7825737,	-0.811108112	;	
		-0.888400853,	1.13427222	;	
		-0.796275139,	-2.10806537	;	
		10.8043213,	-0.171531051	;	
		-0.787267387,	-0.171073928	;	
		-0.788423419,	-0.833416283	;	
		-0.563602388,	3.22163224	;	
		10.8985662,	-2.13224697	;	
		-0.878166616,	1.76446545	;	
		-0.764842033,	2.45185781	;	
		10.3182106,	-3.82583046	;	
		10.6535587,	-2.83315635	;	
		-0.629383206,	-2.88569856	;	
		-0.310299248,	-3.86229539	;	
		8.83762074,	-4.09270048	;	
		1.10182858,	-4.22119045	;	
		9.6456213,	3.03623247	;	
		9.91976833,	2.20570374	;	
		7.15019608,	3.84292603	;	
		3.76996565,	4.50059605	;	
		3.80212021,	-4.48493719	;	
		10.7254896,	1.17212749	;	
		11.4090614,	-1.14015961	;	
		-1.41396415,	-1.15050149	;	
		-1.49379182,	0.806487381	;	
		-1.41572487,	-1.80197644	;	
		11.3882866,	-0.509077489	;	
		11.4067879,	0.148170546	;	
		-1.45483291,	0.151049927	;	
		-1.42823911,	-0.507292151	;	
		11.4776611,	-1.81020772	;	
		-1.51845741,	1.48676515	;	
		10.4740353,	2.84254432	;	
		-1.41619015,	3.0441463	;	
		-1.38385868,	-2.58210874	;	
		-1.49632788,	2.2221756	;	
		11.4699326,	-2.59114242	;	
		11.3336935,	-3.586658	;	
		-0.213339791,	4.07207537	;	
		-1.22978997,	-3.57538176	;	
		10.1856241,	3.89679933	;	
		10.6336813,	1.961707	;	
		11.907918,	-0.813468993	;	
		11.3966103,	0.861654222	;	
		-1.92670214,	-1.46667004	;	
		-2.10143638,	0.460031092	;	
		12.0897837,	-1.37655318	;	
		12.0142698,	-0.236336172	;	
		-2.1711309,	1.13398123	;	
		-2.03295231,	-0.874487519	;	
		11.2739849,	2.51800394	;	
		-2.05577779,	-0.194744527	;	
		-2.06129098,	-2.12878704	;	
		-2.21958733,	1.88218808	;	
		-2.23914623,	2.712116	;	
		12.2172794,	-2.14728498	;	
		-1.2900604,	4.00164223	;	
		12.2820549,	-3.08308434	;	
		-2.08615017,	-3.08525729	;	
		0.953531563,	3.97669029	;	
		11.3529148,	1.64490473	;	
		12.6302252,	-0.760357201	;	
		-2.63362384,	-1.44822586	;	
		-2.79122519,	0.698745191	;	
		12.0521202,	0.490169257	;	
		-2.60326028,	0.099174455	;	
		-2.68584919,	-0.548092425	;	
		-2.92938352,	1.45224774	;	
		12.0416737,	2.12802386	;	
		-3.03967524,	2.27234125	;	
		12.0583019,	1.27669728	;	
		-2.23328042,	3.67210031	;	
		-2.86500096,	-2.46007848	;	
		13.1170664,	-2.44681096	;	
		-3.3605783,	0.038582385	;	
		-3.41175008,	-0.94426471	;	
		12.7080345,	0.065675244	;	
		12.7481461,	0.857282877	;	
		12.0055685,	3.09788036	;	
		12.7748346,	1.69881332	;	
		-3.80722189,	1.76029861	;	
		-3.08256865,	3.17595696	;	
		-3.02000022,	-3.72919965	;	
		13.425539,	0.418327838	;	
		13.4837132,	1.22906065	;	
		11.1363888,	3.57008624	;	
		12.7912369,	2.61268044	;	
		-3.98163772,	2.64366412	;	
		-1.9338547,	-4.07796764	;	
		12.3139544,	-4.19767284	;	
		13.2784204,	-3.51552773	;	
		14.1965723,	0.709293246	;	
		13.3877478,	-0.325974852	;	
		13.5036573,	2.09510589	;	
		11.8749847,	4.08196831	;	
		12.8898773,	3.74711561	;	
		14.0277777,	0.02679934	;	
		14.234354,	1.59295452	;	
		13.491272,	2.9016459	;	
		13.3991089,	-0.99391371	;	
		14.2131147,	2.51979446	;	
		-3.96421742,	-2.61571336	;	
		14.0914364,	-2.70863891	;	
		-3.05524206,	4.10028934	;	
		-3.96435261,	3.65331841	;	
		-4.24374628,	0.459217131	;	
		-4.19770145,	-0.48458907	;	
		-4.1653018,	-1.46941686	;	
		13.948041,	-1.62715518	;	
		-4.27514744,	-3.89081883	;	
		-3.57611465,	0.941178501	;	
		12.9002504,	-1.55867922	;	
		-3.40797877,	-1.78753984	;	
		-4.32541656,	1.23213887	;	
		14.0434885,	3.52809262	;	
		14.207305,	-3.64483333	;	
		14.1271124,	-0.653374076	;	
		2.35310197,	0.466374338	;	
		2.81136727,	1.53069603	;	
		2.52728701,	-0.870487928	;	
		3.49438047,	-2.16166425	;	
		7.63955688,	0.208274081	;	
		7.33697557,	1.17188585	;	
		4.06040859,	2.4735775	;	
		7.17727518,	1.44369483	;	
		7.56495905,	-0.756311119	;	
		6.77757883,	1.99074125	;	
		6.13025093,	2.41745901	;	
		4.36644077,	2.55421162	;	
		6.64843464,	-2.17077804	;	
		4.96286821,	-2.70310092	;	
		5.00227165,	2.66065884	;	
		5.64195967,	-2.6108253	;	
		6.12743711,	-2.36149907	;	
		2.39822698,	-0.100761198	;	
		2.04966903,	0.026558526	;	
		4.6608882,	2.69152927	;	
		5.32469368,	-2.73795462	;	
		3.43628621,	2.22726727	;	
		3.46625519,	-2.60608625	;	
		2.34862113,	-0.704934657	;	
		2.98987365,	-1.81978595	;	
		2.22850752,	-1.18923521	;	
		7.16772842,	-2.10219693	;	
		7.55464697,	0.935251415	;	
		3.19013739,	2.08065438	;	
		3.1427865,	-2.14155269	;	
		2.95046043,	1.82722425	;	
		6.58106041,	2.36627698	;	
		3.70420051,	2.53529096	;	
		2.41476417,	0.963727355	;	
		6.4203577,	-2.4937501	;	
		2.57613969,	1.30524015	;	
		2.32402992,	-0.369539738	;	
		2.76843262,	-1.4459523	;	
		5.26190948,	2.77385187	;	
		7.68314934,	0.552657843	;	
		5.87080622,	2.53982902	;	
		7.27373648,	-1.46420896	;	
		7.16810989,	-1.6371659	;	
		3.92501688,	-2.49062037	;	
		6.04048061,	-2.66625452	;	
		7.06490993,	1.74594748	;	
		7.4953599,	-1.08571148	;	
		7.69408846,	-0.068538286	;	
		4.4457159,	-2.85422158	;	
		5.6161747,	2.68734336	;	
		7.89959478,	-0.420914024	;	
		7.61200714,	1.54156923	;	
		2.53964639,	-2.10950351	;	
		7.74209309,	-1.53771198	;	
		1.87464988,	0.70994848	;	
		5.09341526,	-3.23389387	;	
		4.86407995,	3.16684699	;	
		6.17346287,	3.00177526	;	
		8.13623428,	0.19722186	;	
		4.19032526,	3.00336528	;	
		7.31901073,	2.23741817	;	
		1.87373197,	-0.635929942	;	
		8.11852455,	0.973654568	;	
		2.40138483,	1.90948093	;	
		2.08954811,	1.32467771	;	
		5.78281498,	-3.16695976	;	
		7.97580576,	-0.944658518	;	
		3.15043092,	2.67897463	;];

old_c_mat=[	242,	239,	59	;
	259,	67,	66	;
	234,	88,	87	;
	247,	254,	100	;
	253,	96,	95	;
	390,	360,	384	;
	321,	228,	37	;
	81,	231,	257	;
	320,	77,	76	;
	320,	35,	237	;
	241,	74,	73	;
	242,	232,	15	;
	229,	13,	14	;
	227,	5,	106	;
	20,	2,	21	;
	359,	357,	338	;
	249,	63,	62	;
	232,	58,	57	;
	229,	54,	226	;
	322,	13,	226	;
	235,	12,	227	;
	294,	235,	245	;
	247,	100,	99	;
	30,	29,	3	;
	416,	397,	400	;
	275,	274,	258	;
	299,	280,	279	;
	67,	238,	68	;
	332,	324,	300	;
	417,	404,	392	;
	44,	43,	4	;
	389,	46,	382	;
	248,	255,	90	;
	240,	86,	230	;
	321,	230,	228	;
	257,	37,	228	;
	237,	231,	79	;
	320,	76,	236	;
	236,	76,	75	;
	293,	272,	268	;
	258,	71,	70	;
	388,	370,	381	;
	411,	1,	7	;
	403,	384,	374	;
	283,	246,	253	;
	246,	98,	97	;
	330,	301,	326	;
	356,	355,	337	;
	406,	389,	383	;
	226,	53,	5	;
	226,	54,	53	;
	229,	56,	55	;
	250,	66,	65	;
	231,	80,	79	;
	257,	228,	82	;
	228,	84,	83	;
	230,	85,	84	;
	255,	91,	90	;
	235,	105,	104	;
	227,	226,	5	;
	229,	226,	13	;
	241,	73,	72	;
	241,	236,	74	;
	236,	75,	74	;
	322,	227,	12	;
	227,	106,	105	;
	228,	83,	82	;
	257,	82,	81	;
	242,	16,	239	;
	328,	302,	324	;
	243,	63,	249	;
	233,	78,	77	;
	237,	36,	231	;
	232,	229,	14	;
	229,	55,	54	;
	235,	104,	103	;
	316,	239,	16	;
	320,	296,	35	;
	249,	61,	239	;
	238,	67,	259	;
	258,	72,	71	;
	230,	84,	228	;
	230,	86,	85	;
	240,	87,	86	;
	257,	231,	36	;
	256,	69,	238	;
	258,	70,	256	;
	232,	57,	56	;
	242,	58,	232	;
	232,	56,	229	;
	232,	14,	15	;
	77,	320,	233	;
	233,	79,	78	;
	243,	64,	63	;
	240,	230,	38	;
	234,	89,	88	;
	284,	264,	269	;
	239,	60,	59	;
	333,	303,	310	;
	253,	95,	244	;
	245,	235,	103	;
	254,	102,	101	;
	252,	93,	92	;
	249,	62,	61	;
	261,	277,	244	;
	246,	247,	98	;
	246,	97,	96	;
	251,	248,	234	;
	254,	101,	100	;
	273,	269,	248	;
	234,	248,	89	;
	255,	92,	91	;
	258,	241,	72	;
	235,	11,	12	;
	105,	235,	227	;
	296,	272,	34	;
	296,	236,	272	;
	238,	69,	68	;
	280,	238,	279	;
	237,	35,	36	;
	237,	79,	233	;
	250,	65,	64	;
	282,	259,	276	;
	291,	266,	286	;
	316,	270,	239	;
	295,	38,	39	;
	295,	251,	240	;
	236,	268,	272	;
	274,	241,	258	;
	242,	59,	58	;
	242,	15,	16	;
	250,	64,	243	;
	89,	248,	90	;
	252,	244,	93	;
	270,	266,	249	;
	239,	61,	60	;
	290,	277,	261	;
	244,	94,	93	;
	336,	304,	327	;
	247,	99,	98	;
	292,	265,	287	;
	254,	245,	102	;
	244,	95,	94	;
	317,	294,	271	;
	245,	103,	102	;
	283,	253,	278	;
	265,	247,	260	;
	251,	234,	87	;
	269,	264,	255	;
	266,	263,	249	;
	289,	250,	263	;
	250,	259,	66	;
	251,	87,	240	;
	361,	295,	39	;
	255,	252,	92	;
	290,	262,	285	;
	278,	244,	277	;
	253,	246,	96	;
	267,	254,	265	;
	271,	254,	267	;
	264,	262,	255	;
	262,	261,	252	;
	318,	293,	268	;
	256,	70,	69	;
	231,	81,	80	;
	257,	36,	37	;
	274,	268,	241	;
	282,	279,	238	;
	349,	328,	344	;
	323,	280,	299	;
	301,	278,	277	;
	281,	287,	260	;
	263,	250,	243	;
	289,	276,	250	;
	354,	327,	346	;
	304,	287,	298	;
	260,	247,	246	;
	387,	334,	352	;
	261,	244,	252	;
	290,	261,	262	;
	263,	243,	249	;
	291,	263,	266	;
	262,	252,	255	;
	340,	308,	284	;
	357,	348,	332	;
	269,	255,	248	;
	361,	269,	273	;
	292,	267,	265	;
	265,	254,	247	;
	270,	249,	239	;
	286,	266,	270	;
	288,	271,	267	;
	318,	268,	274	;
	273,	248,	251	;
	358,	340,	41	;
	316,	286,	270	;
	317,	11,	294	;
	271,	245,	254	;
	293,	34,	272	;
	268,	236,	241	;
	295,	273,	251	;
	361,	340,	284	;
	275,	258,	256	;
	319,	274,	275	;
	297,	256,	280	;
	334,	318,	319	;
	344,	328,	324	;
	276,	259,	250	;
	347,	330,	326	;
	307,	281,	283	;
	278,	253,	244	;
	282,	238,	259	;
	345,	299,	329	;
	387,	352,	380	;
	280,	256,	238	;
	281,	260,	246	;
	327,	298,	325	;
	283,	281,	246	;
	364,	354,	346	;
	309,	300,	289	;
	302,	276,	300	;
	324,	302,	300	;
	306,	278,	301	;
	307,	283,	306	;
	373,	358,	42	;
	285,	264,	284	;
	308,	285,	284	;
	285,	262,	264	;
	303,	301,	277	;
	312,	17,	18	;
	291,	289,	263	;
	292,	288,	267	;
	287,	265,	260	;
	315,	10,	288	;
	317,	288,	10	;
	313,	291,	312	;
	311,	285,	308	;
	311,	290,	285	;
	312,	286,	17	;
	339,	312,	18	;
	314,	287,	304	;
	315,	288,	292	;
	342,	33,	293	;
	293,	33,	34	;
	294,	11,	235	;
	294,	245,	271	;
	295,	240,	38	;
	361,	39,	40	;
	296,	34,	35	;
	320,	236,	296	;
	397,	396,	380	;
	297,	275,	256	;
	346,	327,	325	;
	298,	287,	281	;
	305,	282,	302	;
	366,	329,	349	;
	348,	344,	324	;
	300,	276,	289	;
	303,	277,	290	;
	353,	351,	331	;
	305,	279,	282	;
	302,	282,	276	;
	350,	347,	326	;
	341,	9,	315	;
	329,	305,	328	;
	305,	299,	279	;
	331,	306,	330	;
	306,	283,	278	;
	331,	307,	306	;
	307,	298,	281	;
	405,	383,	373	;
	311,	310,	290	;
	313,	289,	291	;
	338,	332,	309	;
	333,	326,	303	;
	310,	303,	290	;
	335,	311,	308	;
	337,	311,	335	;
	312,	291,	286	;
	391,	18,	19	;
	392,	375,	359	;
	313,	309,	289	;
	341,	315,	314	;
	314,	292,	287	;
	315,	9,	10	;
	315,	292,	314	;
	316,	16,	17	;
	316,	17,	286	;
	317,	271,	288	;
	317,	10,	11	;
	319,	318,	274	;
	342,	293,	318	;
	319,	275,	297	;
	343,	319,	297	;
	320,	237,	233	;
	321,	37,	38	;
	321,	38,	230	;
	322,	12,	13	;
	322,	226,	227	;
	362,	343,	323	;
	323,	297,	280	;
	332,	300,	309	;
	363,	349,	344	;
	414,	364,	377	;
	325,	298,	307	;
	376,	368,	367	;
	326,	301,	303	;
	374,	360,	354	;
	327,	304,	298	;
	378,	366,	349	;
	328,	305,	302	;
	372,	370,	362	;
	329,	299,	305	;
	353,	330,	347	;
	330,	306,	301	;
	368,	351,	353	;
	331,	325,	307	;
	338,	309,	313	;
	413,	348,	357	;
	337,	310,	311	;
	369,	350,	355	;
	343,	334,	319	;
	396,	387,	380	;
	358,	335,	308	;
	371,	369,	355	;
	360,	336,	354	;
	336,	314,	304	;
	355,	350,	333	;
	337,	333,	310	;
	339,	338,	313	;
	410,	404,	23	;
	339,	313,	312	;
	392,	391,	20	;
	361,	284,	269	;
	340,	40,	41	;
	390,	9,	341	;
	341,	314,	336	;
	342,	32,	33	;
	342,	318,	334	;
	343,	297,	323	;
	362,	323,	345	;
	348,	324,	332	;
	394,	385,	378	;
	362,	352,	343	;
	345,	323,	299	;
	351,	325,	331	;
	411,	403,	51	;
	350,	326,	333	;
	377,	368,	376	;
	357,	332,	338	;
	418,	410,	24	;
	385,	379,	378	;
	349,	329,	328	;
	355,	333,	337	;
	369,	365,	350	;
	351,	346,	325	;
	353,	331,	330	;
	397,	31,	396	;
	352,	334,	343	;
	367,	347,	365	;
	376,	367,	365	;
	411,	384,	403	;
	354,	336,	327	;
	356,	337,	335	;
	412,	369,	382	;
	373,	356,	335	;
	406,	45,	389	;
	359,	338,	339	;
	413,	357,	375	;
	358,	308,	340	;
	358,	41,	42	;
	391,	359,	339	;
	417,	22,	404	;
	390,	384,	8	;
	360,	341,	336	;
	361,	273,	295	;
	361,	40,	340	;
	372,	345,	366	;
	372,	362,	345	;
	418,	25,	398	;
	363,	344,	348	;
	414,	403,	374	;
	364,	346,	351	;
	412,	407,	376	;
	365,	347,	350	;
	381,	372,	379	;
	366,	345,	329	;
	368,	353,	367	;
	367,	353,	347	;
	408,	376,	407	;
	368,	364,	351	;
	371,	355,	356	;
	415,	407,	412	;
	395,	381,	386	;
	370,	352,	362	;
	383,	356,	373	;
	389,	382,	371	;
	379,	366,	378	;
	386,	379,	385	;
	373,	335,	358	;
	405,	42,	43	;
	374,	354,	364	;
	403,	50,	51	;
	410,	375,	404	;
	375,	357,	359	;
	412,	365,	369	;
	408,	377,	376	;
	409,	49,	50	;
	377,	364,	368	;
	378,	349,	363	;
	393,	386,	385	;
	395,	388,	381	;
	379,	372,	366	;
	396,	32,	387	;
	380,	352,	370	;
	402,	400,	395	;
	381,	370,	372	;
	415,	46,	47	;
	382,	369,	371	;
	406,	405,	43	;
	383,	371,	356	;
	384,	7,	8	;
	384,	360,	374	;
	394,	378,	363	;
	393,	25,	26	;
	399,	393,	26	;
	386,	381,	379	;
	387,	32,	342	;
	387,	342,	334	;
	416,	400,	402	;
	388,	380,	370	;
	389,	45,	46	;
	389,	371,	383	;
	390,	8,	9	;
	390,	341,	360	;
	391,	339,	18	;
	391,	19,	20	;
	392,	359,	391	;
	417,	392,	20	;
	398,	385,	394	;
	399,	26,	27	;
	401,	394,	363	;
	418,	394,	401	;
	399,	395,	386	;
	402,	399,	27	;
	397,	380,	388	;
	396,	31,	32	;
	400,	397,	388	;
	397,	30,	31	;
	398,	25,	393	;
	398,	393,	385	;
	399,	386,	393	;
	402,	27,	28	;
	400,	388,	395	;
	416,	28,	29	;
	413,	401,	363	;
	413,	410,	401	;
	402,	395,	399	;
	416,	402,	28	;
	414,	409,	403	;
	411,	51,	52	;
	404,	22,	23	;
	404,	375,	392	;
	405,	373,	42	;
	406,	43,	44	;
	406,	383,	405	;
	406,	44,	45	;
	407,	47,	48	;
	408,	407,	48	;
	408,	48,	49	;
	409,	408,	49	;
	409,	377,	408	;
	409,	50,	403	;
	410,	23,	24	;
	418,	24,	25	;
	411,	52,	1	;
	411,	7,	384	;
	412,	376,	365	;
	415,	412,	382	;
	413,	363,	348	;
	413,	375,	410	;
	414,	374,	364	;
	414,	377,	409	;
	415,	382,	46	;
	415,	47,	407	;
	416,	29,	30	;
	416,	30,	397	;
	417,	20,	21	;
	417,	21,	22	;
	418,	398,	394	;
	418,	401,	410	;
	427,	161,	160	;
	446,	174,	173	;
	464,	181,	180	;
	450,	186,	185	;
	475,	433,	457	;
	204,	451,	205	;
	449,	213,	212	;
	420,	216,	215	;
	456,	117,	116	;
	441,	422,	448	;
	434,	140,	139	;
	426,	464,	178	;
	485,	469,	427	;
	421,	112,	111	;
	467,	134,	133	;
	453,	147,	146	;
	460,	155,	154	;
	465,	159,	158	;
	428,	183,	182	;
	457,	193,	468	;
	425,	204,	203	;
	478,	451,	425	;
	449,	211,	447	;
	419,	224,	223	;
	437,	224,	419	;
	436,	6,	225	;
	436,	107,	6	;
	422,	124,	123	;
	434,	141,	140	;
	435,	144,	143	;
	435,	145,	144	;
	431,	148,	147	;
	431,	149,	148	;
	426,	177,	176	;
	428,	182,	181	;
	429,	187,	186	;
	429,	188,	187	;
	430,	200,	199	;
	430,	201,	200	;
	425,	203,	202	;
	420,	214,	213	;
	419,	222,	221	;
	422,	125,	124	;
	421,	113,	112	;
	482,	449,	447	;
	431,	445,	150	;
	456,	115,	444	;
	447,	209,	440	;
	178,	464,	179	;
	419,	223,	222	;
	473,	437,	419	;
	420,	215,	214	;
	426,	178,	177	;
	483,	473,	452	;
	436,	455,	108	;
	461,	460,	154	;
	469,	466,	164	;
	467,	132,	131	;
	454,	217,	216	;
	436,	108,	107	;
	443,	118,	456	;
	443,	119,	118	;
	455,	109,	108	;
	455,	436,	437	;
	452,	221,	220	;
	452,	219,	218	;
	456,	116,	115	;
	440,	208,	207	;
	447,	211,	210	;
	444,	115,	114	;
	420,	213,	449	;
	442,	110,	455	;
	442,	111,	110	;
	432,	136,	135	;
	433,	196,	195	;
	451,	206,	205	;
	428,	184,	183	;
	431,	150,	149	;
	60,	431,	453	;
	442,	421,	111	;
	421,	114,	113	;
	448,	121,	443	;
	448,	122,	121	;
	423,	168,	167	;
	130,	129,	462	;
	435,	146,	145	;
	460,	157,	156	;
	423,	166,	466	;
	423,	167,	166	;
	448,	422,	123	;
	422,	126,	125	;
	429,	189,	188	;
	432,	135,	134	;
	424,	175,	174	;
	457,	194,	193	;
	457,	195,	194	;
	443,	120,	119	;
	466,	165,	164	;
	459,	190,	189	;
	427,	159,	465	;
	427,	160,	159	;
	423,	169,	168	;
	461,	154,	153	;
	438,	197,	433	;
	439,	137,	432	;
	425,	451,	204	;
	464,	180,	179	;
	465,	157,	460	;
	446,	172,	171	;
	174,	446,	424	;
	424,	176,	175	;
	462,	467,	130	;
	434,	142,	141	;
	427,	162,	161	;
	458,	171,	170	;
	446,	171,	458	;
	430,	202,	201	;
	461,	153,	152	;
	469,	163,	162	;
	450,	429,	186	;
	438,	430,	199	;
	462,	127,	441	;
	462,	128,	127	;
	431,	147,	453	;
	432,	137,	136	;
	433,	197,	196	;
	434,	139,	439	;
	463,	143,	142	;
	463,	435,	143	;
	467,	131,	130	;
	468,	191,	459	;
	468,	192,	191	;
	437,	436,	225	;
	469,	164,	163	;
	456,	118,	117	;
	460,	156,	155	;
	476,	468,	459	;
	480,	442,	455	;
	455,	110,	109	;
	482,	483,	454	;
	454,	216,	420	;
	454,	218,	217	;
	449,	212,	211	;
	441,	127,	126	;
	72,	73,	470	;
	458,	169,	423	;
	444,	114,	421	;
	448,	123,	122	;
	459,	191,	190	;
	446,	173,	172	;
	447,	210,	209	;
	467,	133,	132	;
	80,	457,	468	;
	468,	193,	192	;
	206,	440,	207	;
	445,	152,	151	;
	440,	209,	208	;
	437,	225,	224	;
	480,	444,	442	;
	466,	166,	165	;
	443,	121,	120	;
	438,	198,	197	;
	439,	138,	137	;
	465,	158,	157	;
	458,	170,	169	;
	452,	220,	219	;
	450,	185,	184	;
	451,	440,	206	;
	441,	126,	422	;
	445,	151,	150	;
	486,	440,	451	;
	450,	184,	428	;
	453,	146,	435	;
	445,	461,	152	;
	462,	129,	128	;
	438,	199,	198	;
	430,	478,	425	;
	419,	221,	452	;
	454,	452,	218	;
	439,	139,	138	;
	482,	420,	449	;
	442,	444,	421	;
	467,	432,	134	;
	474,	432,	467	;
	195,	457,	433	;
	479,	450,	428	;
	470,	424,	446	;
	424,	426,	176	;
	467,	462,	106	;
	479,	464,	470	;
	479,	428,	464	;
	477,	423,	466	;
	478,	430,	438	;
	430,	425,	202	;
	484,	434,	439	;
	434,	463,	142	;
	453,	463,	58	;
	463,	453,	435	;
	464,	428,	181	;
	427,	469,	162	;
	60,	453,	59	;
	476,	429,	450	;
	429,	459,	189	;
	94,	437,	473	;
	470,	464,	426	;
	474,	467,	53	;
	481,	477,	69	;
	483,	92,	473	;
	482,	454,	420	;
	482,	91,	483	;
	448,	103,	441	;
	64,	485,	472	;
	76,	450,	479	;
	485,	427,	465	;
	485,	66,	469	;
	477,	458,	423	;
	81,	457,	80	;
	100,	456,	444	;
	486,	451,	86	;
	484,	463,	434	;
	476,	459,	429	;
	445,	60,	61	;
	424,	470,	426	;
	103,	448,	471	;
	471,	448,	443	;
	88,	482,	447	;
	58,	59,	453	;
	482,	89,	90	;
	472,	460,	461	;
	463,	57,	58	;
	480,	96,	97	;
	481,	446,	458	;
	72,	481,	71	;
	480,	455,	437	;
	85,	451,	478	;
	100,	471,	456	;
	103,	104,	441	;
	483,	452,	454	;
	419,	452,	473	;
	86,	451,	85	;
	88,	486,	87	;
	477,	481,	458	;
	476,	79,	80	;
	472,	485,	465	;
	472,	465,	460	;
	471,	443,	456	;
	55,	474,	54	;
	474,	439,	432	;
	475,	457,	81	;
	475,	438,	433	;
	431,	60,	445	;
	55,	484,	474	;
	477,	469,	67	;
	469,	477,	466	;
	88,	447,	486	;
	486,	447,	440	;
	475,	82,	83	;
	106,	441,	105	;
	441,	106,	462	;
	475,	478,	438	;
	478,	83,	84	;
	471,	100,	101	;
	444,	99,	100	;
	72,	470,	481	;
	482,	88,	89	;
	98,	99,	444	;
	472,	461,	445	;
	472,	62,	63	;
	69,	477,	68	;
	85,	478,	84	;
	484,	439,	474	;
	484,	55,	56	;
	479,	75,	76	;
	480,	97,	98	;
	476,	80,	468	;
	481,	70,	71	;
	481,	470,	446	;
	467,	5,	53	;
	469,	66,	67	;
	437,	94,	95	;
	485,	64,	65	;
	473,	92,	93	;
	441,	104,	105	;
	483,	91,	92	;
	481,	69,	70	;
	484,	56,	57	;
	57,	463,	484	;
	473,	93,	94	;
	486,	86,	87	;
	482,	90,	91	;
	437,	95,	96	;
	472,	63,	64	;
	437,	96,	480	;
	476,	450,	77	;
	77,	450,	76	;
	485,	65,	66	;
	475,	81,	82	;
	474,	53,	54	;
	479,	73,	74	;
	73,	479,	470	;
	445,	61,	62	;
	477,	67,	68	;
	471,	101,	102	;
	476,	78,	79	;
	445,	62,	472	;
	98,	444,	480	;
	103,	471,	102	;
	476,	77,	78	;
	478,	475,	83	;
	479,	74,	75	;
	106,	5,	467	];

	
n_mat = old_n_mat;
c_mat = old_c_mat;

boundary=15;

% g: position index for matrix of essential nodes only
g=0;

% make essen_mat which will contain node coordiantes + names

for h = 1: length(old_c_mat)
i = old_c_mat(h,1);
j = old_c_mat(h,2);
k = old_c_mat(h,3);
    
    if old_n_mat(i,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(i,1),old_n_mat(i,2),i];
       n_mat(i,:)=100;    
    end
    
    if old_n_mat(j,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(j,1),old_n_mat(j,2),j]; 
       n_mat(j,:)=100;    
    end
  
    if old_n_mat(k,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(k,1),old_n_mat(k,2),k];
       n_mat(k,:)=100;    
    end
end    



counter= 0;  % how many essential nodes there are
for n = 1: length(old_n_mat)
    if old_n_mat(n,1) == boundary
        counter= counter+1;
    end
end

% The essential matrix will have repeats so we need to get rid of them 
no_repeat_essen_mat = unique(essen_mat,'rows'); % essential nodes without reps. 3 columns

% how many essentials are within counter? which are the total numer of
% points that needs to be replaced

counter2=0;  % number of ess. nodes that do not to go anywhere
for n=1:counter
    if no_repeat_essen_mat(n,3)<= counter
    counter2=counter2+1;
    end
end


%no_repeat_essen_mat=sortrows(no_repeat_essen_mat,3);
%no_repeat_essen_mat


% some points do not to go anywhere. However, we already removed them. here
% we are putting them back.

%5.
o=1; %indexer to make  index_of_put_back_points matrix
%counter3=0;
index_of_put_back_points = zeros(1,1);
for n = 1:counter
    if no_repeat_essen_mat(n,3) <= counter
        %counter3=counter3+1;
        n_mat(no_repeat_essen_mat(n,3),:)= [no_repeat_essen_mat(n,1) , no_repeat_essen_mat(n,2)];
   
        index_of_put_back_points(o,1)=[no_repeat_essen_mat(n,3)];
        o=o+1;
    end
end


%6.
no_repeat_essen_mat(no_repeat_essen_mat(:,3)<= counter,:)= [];

% now, we will get rid of the node number from the eseential matrix. So
% that we can be left jsut with the coordinates of the nodes only

no_repeat_essen_mat_2col= no_repeat_essen_mat;
no_repeat_essen_mat_2col_index=no_repeat_essen_mat(:,3);
no_repeat_essen_mat_2col(:,3)=[];


% now, we have the essential matrix ready to be inputed into the node
% matrix in the first rows where there are not already essential nodes. However, before we do this, we will need to
% collect the first rows (not including essential nodes) and send them down to the previous positions of the
% essential nodes

% points_back: get the points from the beginning of the nodes, leave the empty spaces so
% that we can bring in the essential nodes forward

%7.
points_back_index = zeros(counter-counter2,1);
points_back_index;
index_of_put_back_points;

for n= 1 : counter
  
    points_back(n,:) = [n_mat(n,:)];
    points_back_index(n,1) = [n];
    
end


points_back(index_of_put_back_points,:)= [];
points_back_index(index_of_put_back_points,:)=[]  ;



for n = 1: counter-counter2
    n_mat(points_back_index(n,1),:) = no_repeat_essen_mat_2col(n,:);
end

for n = 1: counter-counter2
    n_mat(no_repeat_essen_mat_2col_index(n,1),:) = points_back(n,:);
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == points_back_index(m)
                c_mat(h,l) = c_mat(h,l)+1000;
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(no_repeat_essen_mat_2col_index)
            if c_mat(h,l) == no_repeat_essen_mat_2col_index(m)
                c_mat(h,l) = c_mat(h,l)+2000;
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == points_back_index(m)+1000
                c_mat(h,l) = no_repeat_essen_mat_2col_index(m);
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == no_repeat_essen_mat_2col_index(m)+2000
                c_mat(h,l) =points_back_index(m);
            end
        end
    end
end
end
