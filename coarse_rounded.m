%% initializing code
function[n_mat, c_mat, counter, x] =coarse_rounded
x=-10;
old_c_mat=	[	155	,	145	,	21	;
		232	,	218	,	165	;
		163	,	155	,	22	;
		181	,	32	,	180	;
		191	,	160	,	149	;
		161	,	39	,	160	;
		150	,	40	,	41	;
		193	,	42	,	69	;
		159	,	151	,	44	;
		147	,	17	,	18	;
		146	,	64	,	65	;
		192	,	19	,	145	;
		185	,	55	,	184	;
		154	,	13	,	14	;
		202	,	172	,	197	;
		164	,	159	,	45	;
		28	,	2	,	29	;
		165	,	28	,	29	;
		182	,	31	,	181	;
		167	,	26	,	166	;
		168	,	25	,	167	;
		215	,	201	,	198	;
		226	,	198	,	203	;
		214	,	155	,	189	;
		145	,	20	,	21	;
		145	,	19	,	20	;
		192	,	18	,	19	;
		147	,	18	,	63	;
		190	,	147	,	64	;
		156	,	17	,	147	;
		216	,	158	,	194	;
		190	,	157	,	156	;
		36	,	35	,	3	;
		162	,	36	,	37	;
		222	,	208	,	217	;
		208	,	180	,	179	;
		180	,	33	,	179	;
		209	,	180	,	208	;
		232	,	29	,	30	;
		52	,	51	,	4	;
		170	,	51	,	52	;
		148	,	65	,	7	;
		172	,	49	,	171	;
		173	,	48	,	172	;
		204	,	200	,	199	;
		233	,	199	,	202	;
		177	,	159	,	164	;
		151	,	43	,	44	;
		69	,	43	,	151	;
		193	,	41	,	42	;
		150	,	41	,	193	;
		160	,	150	,	149	;
		160	,	40	,	150	;
		149	,	71	,	72	;
		162	,	37	,	153	;
		58	,	1	,	13	;
		154	,	58	,	13	;
		221	,	210	,	216	;
		210	,	184	,	183	;
		184	,	56	,	183	;
		186	,	54	,	185	;
		207	,	52	,	53	;
		214	,	145	,	155	;
		214	,	189	,	61	;
		189	,	188	,	60	;
		175	,	151	,	159	;
		177	,	68	,	175	;
		178	,	67	,	177	;
		145	,	6	,	62	;
		192	,	145	,	62	;
		157	,	16	,	156	;
		148	,	146	,	65	;
		147	,	63	,	64	;
		190	,	64	,	146	;
		171	,	50	,	170	;
		219	,	170	,	207	;
		244	,	72	,	152	;
		225	,	191	,	149	;
		150	,	70	,	71	;
		150	,	71	,	149	;
		151	,	8	,	69	;
		43	,	69	,	42	;
		152	,	72	,	5	;
		203	,	167	,	196	;
		217	,	153	,	195	;
		153	,	37	,	38	;
		206	,	58	,	154	;
		158	,	15	,	157	;
		155	,	21	,	22	;
		163	,	22	,	23	;
		216	,	206	,	154	;
		156	,	16	,	17	;
		194	,	157	,	190	;
		157	,	15	,	16	;
		158	,	154	,	14	;
		158	,	14	,	15	;
		159	,	44	,	45	;
		164	,	45	,	46	;
		191	,	161	,	160	;
		160	,	39	,	40	;
		161	,	153	,	38	;
		161	,	38	,	39	;
		205	,	35	,	162	;
		162	,	35	,	36	;
		169	,	23	,	24	;
		201	,	189	,	163	;
		174	,	46	,	47	;
		177	,	175	,	159	;
		166	,	27	,	165	;
		165	,	27	,	28	;
		196	,	167	,	166	;
		166	,	26	,	27	;
		234	,	226	,	223	;
		167	,	25	,	26	;
		187	,	152	,	5	;
		168	,	24	,	25	;
		169	,	163	,	23	;
		169	,	24	,	168	;
		211	,	184	,	210	;
		170	,	50	,	51	;
		197	,	172	,	171	;
		171	,	49	,	50	;
		236	,	233	,	224	;
		172	,	48	,	49	;
		176	,	148	,	7	;
		173	,	47	,	48	;
		174	,	164	,	46	;
		174	,	47	,	173	;
		175	,	68	,	8	;
		175	,	8	,	151	;
		176	,	7	,	66	;
		178	,	66	,	67	;
		200	,	177	,	164	;
		177	,	67	,	68	;
		200	,	178	,	177	;
		178	,	176	,	66	;
		179	,	33	,	34	;
		205	,	179	,	34	;
		212	,	182	,	181	;
		180	,	32	,	33	;
		228	,	208	,	222	;
		181	,	31	,	32	;
		232	,	182	,	218	;
		182	,	30	,	31	;
		183	,	56	,	57	;
		206	,	183	,	57	;
		213	,	186	,	185	;
		184	,	55	,	56	;
		229	,	210	,	221	;
		185	,	54	,	55	;
		219	,	207	,	186	;
		186	,	53	,	54	;
		187	,	5	,	59	;
		188	,	187	,	59	;
		188	,	59	,	60	;
		201	,	188	,	189	;
		189	,	60	,	61	;
		189	,	155	,	163	;
		190	,	156	,	147	;
		235	,	190	,	146	;
		225	,	222	,	195	;
		195	,	161	,	191	;
		192	,	62	,	63	;
		192	,	63	,	18	;
		193	,	69	,	70	;
		150	,	193	,	70	;
		194	,	158	,	157	;
		241	,	235	,	146	;
		217	,	205	,	162	;
		195	,	153	,	161	;
		239	,	226	,	234	;
		218	,	196	,	166	;
		220	,	176	,	204	;
		219	,	171	,	170	;
		198	,	169	,	168	;
		203	,	198	,	168	;
		199	,	174	,	173	;
		202	,	199	,	173	;
		200	,	164	,	174	;
		200	,	174	,	199	;
		201	,	163	,	169	;
		201	,	169	,	198	;
		202	,	173	,	172	;
		233	,	220	,	204	;
		203	,	168	,	167	;
		223	,	203	,	196	;
		204	,	176	,	178	;
		204	,	178	,	200	;
		205	,	34	,	35	;
		217	,	162	,	153	;
		206	,	57	,	58	;
		216	,	154	,	158	;
		207	,	170	,	52	;
		207	,	53	,	186	;
		217	,	208	,	179	;
		231	,	212	,	209	;
		240	,	234	,	231	;
		209	,	181	,	180	;
		216	,	210	,	183	;
		243	,	229	,	241	;
		243	,	236	,	230	;
		211	,	185	,	184	;
		238	,	218	,	212	;
		212	,	181	,	209	;
		237	,	219	,	213	;
		213	,	185	,	211	;
		214	,	61	,	6	;
		214	,	6	,	145	;
		215	,	187	,	188	;
		215	,	188	,	201	;
		221	,	216	,	194	;
		216	,	183	,	206	;
		222	,	217	,	195	;
		217	,	179	,	205	;
		218	,	166	,	165	;
		218	,	182	,	212	;
		219	,	186	,	213	;
		219	,	197	,	171	;
		224	,	202	,	197	;
		220	,	148	,	176	;
		235	,	221	,	194	;
		227	,	146	,	148	;
		225	,	195	,	191	;
		228	,	222	,	225	;
		239	,	234	,	152	;
		238	,	223	,	196	;
		237	,	224	,	197	;
		230	,	213	,	211	;
		244	,	242	,	225	;
		242	,	240	,	228	;
		226	,	215	,	198	;
		226	,	203	,	223	;
		227	,	148	,	220	;
		236	,	227	,	220	;
		240	,	231	,	228	;
		228	,	209	,	208	;
		229	,	211	,	210	;
		241	,	221	,	235	;
		237	,	230	,	224	;
		230	,	211	,	229	;
		238	,	231	,	223	;
		231	,	209	,	228	;
		232	,	165	,	29	;
		232	,	30	,	182	;
		233	,	204	,	199	;
		233	,	202	,	224	;
		239	,	152	,	187	;
		234	,	223	,	231	;
		235	,	194	,	190	;
		241	,	146	,	227	;
		236	,	220	,	233	;
		236	,	224	,	230	;
		237	,	197	,	219	;
		237	,	213	,	230	;
		238	,	196	,	218	;
		238	,	212	,	231	;
		239	,	187	,	215	;
		239	,	215	,	226	;
		242	,	228	,	225	;
		240	,	152	,	234	;
		243	,	241	,	227	;
		241	,	229	,	221	;
		244	,	225	,	149	;
		242	,	152	,	240	;
		243	,	230	,	229	;
		243	,	227	,	236	;
		244	,	149	,	72	;
		244	,	152	,	242	;
		273	,	88	,	89	;
		300	,	292	,	143	;
		300	,	144	,	289	;
		333	,	293	,	302	;
		310	,	139	,	140	;
		338	,	336	,	70	;
		299	,	295	,	135	;
		299	,	135	,	136	;
		288	,	285	,	12	;
		262	,	279	,	117	;
		328	,	287	,	326	;
		297	,	107	,	108	;
		308	,	298	,	106	;
		344	,	298	,	337	;
		311	,	306	,	102	;
		309	,	101	,	306	;
		332	,	303	,	309	;
		304	,	99	,	303	;
		301	,	286	,	97	;
		255	,	94	,	95	;
		327	,	286	,	301	;
		305	,	104	,	296	;
		280	,	128	,	129	;
		330	,	288	,	294	;
		310	,	140	,	293	;
		302	,	142	,	292	;
		246	,	81	,	82	;
		312	,	276	,	249	;
		284	,	73	,	281	;
		266	,	252	,	110	;
		266	,	110	,	111	;
		283	,	109	,	252	;
		286	,	271	,	10	;
		271	,	255	,	95	;
		271	,	95	,	96	;
		265	,	94	,	255	;
		265	,	93	,	94	;
		253	,	91	,	92	;
		268	,	91	,	253	;
		272	,	90	,	268	;
		272	,	89	,	90	;
		256	,	87	,	88	;
		257	,	87	,	256	;
		258	,	86	,	257	;
		259	,	85	,	258	;
		260	,	84	,	259	;
		318	,	260	,	259	;
		261	,	82	,	83	;
		274	,	81	,	246	;
		247	,	79	,	80	;
		275	,	79	,	247	;
		248	,	77	,	78	;
		249	,	77	,	248	;
		276	,	76	,	249	;
		277	,	75	,	276	;
		281	,	74	,	277	;
		304	,	98	,	99	;
		303	,	99	,	100	;
		306	,	101	,	102	;
		311	,	103	,	305	;
		296	,	104	,	105	;
		308	,	106	,	107	;
		287	,	11	,	283	;
		323	,	252	,	266	;
		278	,	112	,	269	;
		269	,	113	,	254	;
		270	,	114	,	115	;
		270	,	254	,	114	;
		117	,	279	,	116	;
		262	,	117	,	118	;
		262	,	118	,	119	;
		263	,	262	,	119	;
		263	,	120	,	121	;
		264	,	263	,	121	;
		264	,	122	,	250	;
		250	,	122	,	123	;
		352	,	264	,	250	;
		251	,	124	,	125	;
		124	,	251	,	250	;
		251	,	125	,	126	;
		245	,	126	,	127	;
		128	,	280	,	245	;
		280	,	129	,	130	;
		358	,	280	,	282	;
		130	,	282	,	280	;
		282	,	131	,	132	;
		285	,	282	,	132	;
		289	,	9	,	284	;
		292	,	142	,	143	;
		293	,	140	,	141	;
		290	,	138	,	139	;
		307	,	138	,	290	;
		299	,	136	,	291	;
		294	,	133	,	134	;
		356	,	251	,	245	;
		245	,	127	,	128	;
		314	,	246	,	261	;
		274	,	247	,	80	;
		274	,	80	,	81	;
		275	,	248	,	78	;
		275	,	78	,	79	;
		361	,	248	,	275	;
		322	,	312	,	59	;
		249	,	76	,	77	;
		250	,	123	,	124	;
		354	,	67	,	352	;
		251	,	126	,	245	;
		356	,	354	,	251	;
		323	,	283	,	252	;
		252	,	109	,	110	;
		267	,	92	,	93	;
		316	,	268	,	253	;
		360	,	269	,	313	;
		254	,	113	,	114	;
		315	,	255	,	271	;
		315	,	265	,	255	;
		362	,	256	,	273	;
		317	,	257	,	256	;
		363	,	257	,	317	;
		257	,	86	,	87	;
		363	,	258	,	257	;
		258	,	85	,	86	;
		314	,	261	,	260	;
		259	,	84	,	85	;
		318	,	314	,	260	;
		260	,	83	,	84	;
		261	,	246	,	82	;
		261	,	83	,	260	;
		357	,	353	,	67	;
		279	,	270	,	115	;
		355	,	353	,	263	;
		263	,	119	,	120	;
		355	,	264	,	352	;
		264	,	121	,	122	;
		316	,	253	,	267	;
		315	,	267	,	265	;
		278	,	111	,	112	;
		360	,	278	,	269	;
		267	,	253	,	92	;
		267	,	93	,	265	;
		321	,	272	,	268	;
		268	,	90	,	91	;
		269	,	112	,	113	;
		313	,	254	,	270	;
		279	,	115	,	116	;
		320	,	313	,	270	;
		271	,	96	,	10	;
		359	,	315	,	271	;
		362	,	272	,	321	;
		273	,	89	,	272	;
		362	,	273	,	272	;
		273	,	256	,	88	;
		314	,	274	,	246	;
		319	,	247	,	274	;
		361	,	247	,	319	;
		361	,	275	,	247	;
		322	,	276	,	312	;
		276	,	75	,	76	;
		322	,	281	,	277	;
		277	,	74	,	75	;
		360	,	323	,	266	;
		278	,	266	,	111	;
		357	,	262	,	353	;
		357	,	279	,	262	;
		282	,	130	,	131	;
		358	,	351	,	280	;
		324	,	284	,	281	;
		281	,	73	,	74	;
		285	,	132	,	12	;
		358	,	282	,	325	;
		326	,	287	,	283	;
		283	,	11	,	109	;
		324	,	289	,	284	;
		284	,	9	,	73	;
		288	,	12	,	133	;
		325	,	285	,	288	;
		359	,	286	,	327	;
		286	,	10	,	97	;
		328	,	326	,	7	;
		287	,	108	,	11	;
		294	,	288	,	133	;
		330	,	325	,	288	;
		329	,	300	,	289	;
		289	,	144	,	9	;
		345	,	341	,	71	;
		307	,	291	,	137	;
		291	,	136	,	137	;
		307	,	137	,	138	;
		300	,	143	,	144	;
		302	,	293	,	141	;
		302	,	141	,	142	;
		343	,	293	,	333	;
		295	,	294	,	134	;
		339	,	330	,	294	;
		340	,	295	,	299	;
		295	,	134	,	135	;
		298	,	296	,	105	;
		335	,	305	,	296	;
		347	,	297	,	328	;
		297	,	108	,	287	;
		344	,	337	,	65	;
		298	,	105	,	106	;
		338	,	291	,	336	;
		340	,	299	,	338	;
		329	,	289	,	324	;
		334	,	292	,	300	;
		301	,	97	,	98	;
		331	,	327	,	301	;
		348	,	302	,	292	;
		348	,	333	,	302	;
		309	,	100	,	101	;
		350	,	304	,	303	;
		350	,	331	,	304	;
		304	,	301	,	98	;
		349	,	311	,	305	;
		305	,	103	,	104	;
		311	,	102	,	103	;
		342	,	309	,	306	;
		345	,	290	,	341	;
		345	,	307	,	290	;
		308	,	107	,	297	;
		347	,	308	,	297	;
		342	,	332	,	309	;
		309	,	303	,	100	;
		343	,	310	,	293	;
		310	,	290	,	139	;
		349	,	305	,	335	;
		346	,	342	,	306	;
		312	,	249	,	248	;
		322	,	59	,	5	;
		313	,	269	,	254	;
		360	,	7	,	323	;
		314	,	60	,	59	;
		319	,	314	,	59	;
		315	,	6	,	61	;
		316	,	315	,	61	;
		321	,	316	,	61	;
		316	,	267	,	315	;
		362	,	60	,	317	;
		363	,	318	,	259	;
		363	,	259	,	258	;
		318	,	60	,	314	;
		361	,	319	,	59	;
		319	,	274	,	314	;
		320	,	66	,	313	;
		320	,	270	,	279	;
		321	,	268	,	316	;
		362	,	321	,	61	;
		324	,	322	,	5	;
		322	,	277	,	276	;
		326	,	323	,	7	;
		360	,	266	,	278	;
		329	,	324	,	5	;
		324	,	281	,	322	;
		358	,	68	,	351	;
		325	,	282	,	285	;
		326	,	283	,	323	;
		328	,	7	,	65	;
		327	,	62	,	6	;
		359	,	327	,	6	;
		347	,	337	,	308	;
		328	,	297	,	287	;
		329	,	5	,	72	;
		334	,	329	,	72	;
		330	,	69	,	8	;
		330	,	8	,	325	;
		331	,	301	,	304	;
		331	,	62	,	327	;
		332	,	63	,	62	;
		350	,	332	,	62	;
		333	,	72	,	71	;
		343	,	341	,	310	;
		348	,	334	,	72	;
		334	,	300	,	329	;
		344	,	296	,	298	;
		349	,	346	,	311	;
		338	,	70	,	69	;
		336	,	291	,	307	;
		344	,	65	,	64	;
		337	,	298	,	308	;
		340	,	339	,	295	;
		338	,	299	,	291	;
		339	,	69	,	330	;
		339	,	294	,	295	;
		340	,	338	,	69	;
		340	,	69	,	339	;
		341	,	290	,	310	;
		345	,	71	,	70	;
		346	,	306	,	311	;
		342	,	63	,	332	;
		343	,	333	,	71	;
		343	,	71	,	341	;
		344	,	64	,	335	;
		344	,	335	,	296	;
		345	,	70	,	336	;
		345	,	336	,	307	;
		349	,	63	,	346	;
		346	,	63	,	342	;
		347	,	328	,	65	;
		347	,	65	,	337	;
		348	,	292	,	334	;
		348	,	72	,	333	;
		349	,	335	,	64	;
		349	,	64	,	63	;
		350	,	303	,	332	;
		350	,	62	,	331	;
		356	,	351	,	68	;
		351	,	245	,	280	;
		354	,	352	,	250	;
		355	,	352	,	67	;
		357	,	67	,	66	;
		353	,	262	,	263	;
		354	,	250	,	251	;
		354	,	68	,	67	;
		355	,	67	,	353	;
		355	,	263	,	264	;
		356	,	245	,	351	;
		356	,	68	,	354	;
		357	,	66	,	320	;
		357	,	320	,	279	;
		358	,	325	,	8	;
		358	,	8	,	68	;
		359	,	6	,	315	;
		359	,	271	,	286	;
		360	,	313	,	66	;
		360	,	66	,	7	;
		361	,	59	,	312	;
		361	,	312	,	248	;
		362	,	61	,	60	;
		362	,	317	,	256	;
		363	,	317	,	60	;
		363	,	60	,	318	];

old_n_mat=	[	10	,	5	;
			-10	,	5	;
			-10	,	-5	;
			10	,	-5	;
			-3.05799603	,	-0.555000007	;
			0.555000007	,	3.04457569	;
			2.98049998	,	0.490924418	;
			-0.477503866	,	-2.98049998	;
			-2.35700011	,	-1.17850006	;
			1.17850006	,	2.35700011	;
			2.35700011	,	1.17850006	;
			-1.17850006	,	-2.35700011	;
			8.82352924	,	5	;
			7.64705896	,	5	;
			6.47058821	,	5	;
			5.29411745	,	5	;
			4.11764717	,	5	;
			2.94117641	,	5	;
			1.7647059	,	5	;
			0.588235319	,	5	;
			-0.588235319	,	5	;
			-1.7647059	,	5	;
			-2.94117641	,	5	;
			-4.11764717	,	5	;
			-5.29411745	,	5	;
			-6.47058821	,	5	;
			-7.64705896	,	5	;
			-8.82352924	,	5	;
			-10	,	3.75	;
			-10	,	2.5	;
			-10	,	1.25	;
			-10	,	0	;
			-10	,	-1.25	;
			-10	,	-2.5	;
			-10	,	-3.75	;
			-8.82352924	,	-5	;
			-7.64705896	,	-5	;
			-6.47058821	,	-5	;
			-5.29411745	,	-5	;
			-4.11764717	,	-5	;
			-2.94117641	,	-5	;
			-1.7647059	,	-5	;
			-0.588235319	,	-5	;
			0.588235319	,	-5	;
			1.7647059	,	-5	;
			2.94117641	,	-5	;
			4.11764717	,	-5	;
			5.29411745	,	-5	;
			6.47058821	,	-5	;
			7.64705896	,	-5	;
			8.82352924	,	-5	;
			10	,	-3.75	;
			10	,	-2.5	;
			10	,	-1.25	;
			10	,	0	;
			10	,	1.25	;
			10	,	2.5	;
			10	,	3.75	;
			-2.15474701	,	0.344893903	;
			-1.2514981	,	1.24478781	;
			-0.348249018	,	2.14468169	;
			1.54254591	,	3.53952956	;
			2.63064528	,	3.34909272	;
			3.39138746	,	2.54815698	;
			3.52559924	,	1.45170188	;
			2.11599898	,	-0.376931697	;
			1.2514981	,	-1.24478781	;
			0.386997104	,	-2.11264396	;
			-1.442186	,	-3.54370403	;
			-2.55211568	,	-3.41774178	;
			-3.36605787	,	-2.65268731	;
			-3.56044292	,	-1.55267608	;
			-2.21557999	,	-1.03708005	;
			-2.0741601	,	-0.895659983	;
			-1.93273997	,	-0.754239976	;
			-1.79131997	,	-0.612820029	;
			-1.64989996	,	-0.471399993	;
			-1.50847995	,	-0.329979986	;
			-1.36705995	,	-0.188559994	;
			-1.22564006	,	-0.047139999	;
			-1.08422005	,	0.094279997	;
			-0.942799985	,	0.235699996	;
			-0.801379979	,	0.377119988	;
			-0.659959972	,	0.518540025	;
			-0.518540025	,	0.659959972	;
			-0.377119988	,	0.801379979	;
			-0.235699996	,	0.942799985	;
			-0.094279997	,	1.08422005	;
			0.047139999	,	1.22564006	;
			0.188559994	,	1.36705995	;
			0.329979986	,	1.50847995	;
			0.471399993	,	1.64989996	;
			0.612820029	,	1.79131997	;
			0.754239976	,	1.93273997	;
			0.895659983	,	2.0741601	;
			1.03708005	,	2.21557999	;
			1.33663929	,	2.48089433	;
			1.51983321	,	2.56334305	;
			1.71743512	,	2.59955502	;
			1.91796112	,	2.58742547	;
			2.10975742	,	2.52765918	;
			2.28167748	,	2.4237299	;
			2.4237299	,	2.28167748	;
			2.52765918	,	2.10975742	;
			2.58742547	,	1.91796112	;
			2.59955502	,	1.71743512	;
			2.56334305	,	1.51983321	;
			2.48089433	,	1.33663929	;
			2.21557999	,	1.03708005	;
			2.0741601	,	0.895659983	;
			1.93273997	,	0.754239976	;
			1.79131997	,	0.612820029	;
			1.64989996	,	0.471399993	;
			1.50847995	,	0.329979986	;
			1.36705995	,	0.188559994	;
			1.22564006	,	0.047139999	;
			1.08422005	,	-0.094279997	;
			0.942799985	,	-0.235699996	;
			0.801379979	,	-0.377119988	;
			0.659959972	,	-0.518540025	;
			0.518540025	,	-0.659959972	;
			0.377119988	,	-0.801379979	;
			0.235699996	,	-0.942799985	;
			0.094279997	,	-1.08422005	;
			-0.047139999	,	-1.22564006	;
			-0.188559994	,	-1.36705995	;
			-0.329979986	,	-1.50847995	;
			-0.471399993	,	-1.64989996	;
			-0.612820029	,	-1.79131997	;
			-0.754239976	,	-1.93273997	;
			-0.895659983	,	-2.0741601	;
			-1.03708005	,	-2.21557999	;
			-1.33663929	,	-2.48089433	;
			-1.51983321	,	-2.56334305	;
			-1.71743512	,	-2.59955502	;
			-1.91796112	,	-2.58742547	;
			-2.10975742	,	-2.52765918	;
			-2.28167748	,	-2.4237299	;
			-2.4237299	,	-2.28167748	;
			-2.52765918	,	-2.10975742	;
			-2.58742547	,	-1.91796112	;
			-2.59955502	,	-1.71743512	;
			-2.56334305	,	-1.51983321	;
			-2.48089433	,	-1.33663929	;
			0.540812016	,	4.11630678	;
			4.6350832	,	1.54216814	;
			3.79520464	,	3.85102725	;
			3.97971368	,	0.38366577	;
			-4.49831104	,	-2.62121487	;
			-3.71111608	,	-3.76388025	;
			-0.29984653	,	-4.08722544	;
			-4.46654463	,	-0.251211256	;
			-7.1033268	,	-3.93081784	;
			8.37593365	,	3.90799117	;
			-1.00710678	,	3.98399162	;
			4.78761435	,	4.18320322	;
			5.81177807	,	4.02851009	;
			7.06397343	,	3.9411931	;
			1.0650636	,	-3.96465731	;
			-4.83745098	,	-3.90496683	;
			-5.94662571	,	-3.97910619	;
			-8.38722992	,	-3.90006351	;
			-2.29077196	,	3.91164589	;
			2.29710269	,	-3.90723681	;
			-8.3899107	,	3.89304781	;
			-7.10940552	,	3.91686535	;
			-5.89407396	,	3.96415854	;
			-4.71600866	,	3.97082186	;
			-3.52915525	,	3.94118738	;
			8.38767624	,	-3.9067781	;
			7.11085033	,	-3.9265511	;
			5.89190865	,	-3.96969533	;
			4.71057367	,	-3.97329402	;
			3.52194023	,	-3.94078612	;
			0.446694195	,	-3.16749859	;
			3.26794696	,	-0.61198014	;
			1.54784274	,	-2.69021654	;
			2.46466303	,	-1.58525562	;
			-8.91449261	,	-1.90591621	;
			-8.91823483	,	-0.646432936	;
			-8.91796398	,	0.635711372	;
			-8.92868042	,	1.89368343	;
			8.91161156	,	1.90700805	;
			8.92071629	,	0.646179616	;
			8.92220306	,	-0.642828941	;
			8.92742634	,	-1.90896726	;
			-3.3719492	,	0.656488121	;
			-2.4989109	,	1.59790671	;
			-1.53182924	,	2.6994071	;
			4.91866446	,	3.04081392	;
			-5.51266575	,	-3.08070564	;
			1.88397717	,	4.20098591	;
			-2.17504597	,	-4.24036121	;
			6.322258	,	2.95414639	;
			-6.51588345	,	-2.92834258	;
			-6.50104332	,	2.89098525	;
			6.50847673	,	-2.90863681	;
			-4.17097473	,	2.90257692	;
			4.16038704	,	-2.89439511	;
			2.94436431	,	-2.79741216	;
			-2.95432401	,	2.81161785	;
			5.3442235	,	-2.9273541	;
			-5.34083176	,	2.92144704	;
			3.67666554	,	-1.76356041	;
			-9.01552105	,	-2.95476079	;
			9.00786781	,	2.95816827	;
			9.02458954	,	-2.95832133	;
			-7.84452438	,	-1.33274102	;
			-7.80501318	,	-0.010163426	;
			7.83200359	,	1.28804231	;
			7.85027218	,	-0.048481949	;
			-7.83674335	,	1.31486225	;
			7.86619806	,	-1.35384107	;
			-0.358274609	,	3.19779253	;
			-3.69228387	,	1.81301117	;
			7.74544144	,	2.68532157	;
			-7.81848717	,	-2.69615507	;
			-7.81569862	,	2.68342066	;
			7.82734203	,	-2.70229554	;
			4.38485956	,	-0.770299137	;
			6.70873022	,	1.78082967	;
			-6.92906809	,	-1.93779802	;
			-5.92917252	,	1.87751937	;
			5.97773457	,	-1.90972328	;
			-5.77067852	,	-1.95808315	;
			-4.80504751	,	1.89779019	;
			5.05335665	,	0.209422886	;
			-6.60639668	,	-0.779892623	;
			6.8221674	,	0.533313811	;
			6.71076775	,	-0.806623697	;
			-6.60254622	,	0.731380463	;
			-9.02685738	,	2.94403052	;
			4.84093666	,	-1.86462605	;
			-5.31690359	,	0.863456964	;
			5.68247986	,	2.0667243	;
			5.49312115	,	-0.855681002	;
			6.97810364	,	-1.9362241	;
			-6.93704081	,	1.89963353	;
			-4.3305459	,	0.995907068	;
			-5.70095301	,	-0.066670395	;
			5.81548166	,	1.02337027	;
			-5.46258831	,	-0.901340067	;
			5.97897911	,	0.020760454	;
			-4.75171328	,	-1.45690513	;
			-0.2749376	,	-1.68101323	;
			-1.12292743	,	0.28360334	;
			-1.46056604	,	-0.000412538	;
			-1.70163703	,	-0.26467675	;
			-1.81313455	,	-0.417018473	;
			0.305675834	,	-1.11609352	;
			0.056560528	,	-1.42988515	;
			2.25856543	,	0.858026624	;
			0.306740731	,	1.70335138	;
			1.69552422	,	0.290523946	;
			0.725560069	,	2.11002254	;
			-0.342889965	,	1.15365958	;
			-0.495503247	,	0.979210377	;
			-0.582758427	,	0.828433752	;
			-0.741572499	,	0.724160254	;
			-0.915505588	,	0.555731654	;
			-1.01436019	,	0.392636895	;
			1.10085809	,	-0.316216856	;
			0.808303475	,	-0.621525109	;
			0.598220587	,	-0.870934844	;
			0.602371752	,	1.9907887	;
			2.14929485	,	0.691422701	;
			0.438157499	,	1.87667274	;
			0.138506278	,	1.60167277	;
			1.86466575	,	0.404705167	;
			1.5866127	,	0.119267002	;
			0.896929681	,	2.30971384	;
			-0.05152886	,	1.43809354	;
			-0.17127414	,	1.27051842	;
			-1.29499984	,	0.175429806	;
			-1.55462945	,	-0.158512503	;
			-1.98025346	,	-0.525892377	;
			-2.10996461	,	-0.69248718	;
			1.98776603	,	0.566678882	;
			1.40111697	,	-0.094410271	;
			-0.556631505	,	-2.00217223	;
			-2.27618456	,	-0.824606657	;
			-0.784483194	,	-2.25791693	;
			2.41862965	,	0.967344463	;
			-2.39688587	,	-1.00669956	;
			-0.990562439	,	-2.38900352	;
			1.1258812	,	2.56208563	;
			2.58861804	,	1.141379	;
			-1.13119936	,	-2.56241369	;
			-2.5710218	,	-1.14916897	;
			-2.52117538	,	-2.48429513	;
			-2.07405114	,	-2.76027584	;
			-2.78402567	,	-1.60041773	;
			-2.76075625	,	-2.0797255	;
			-1.3517015	,	-2.70878863	;
			-1.58124256	,	-2.7823441	;
			2.7546823	,	2.07208061	;
			2.71637511	,	1.35656786	;
			2.80070829	,	1.81915414	;
			-1.81913924	,	-2.80719066	;
			-2.71691561	,	-1.37202871	;
			1.3645786	,	2.71366477	;
			-2.80676627	,	-1.83798218	;
			1.83461666	,	2.80179167	;
			1.59839022	,	2.78375268	;
			2.64349031	,	2.31926298	;
			2.28994751	,	2.65640712	;
			-2.32306385	,	-2.64888382	;
			2.78182817	,	1.582968	;
			2.0773685	,	2.75845742	;
			-2.66275764	,	-2.29351425	;
			2.48134995	,	2.52125287	;
			-1.94663727	,	-0.223621026	;
			1.85787451	,	0.112641022	;
			-1.29188275	,	0.502108037	;
			0.48292622	,	2.24609661	;
			0.152781874	,	1.87982166	;
			-0.657875299	,	1.15892577	;
			-0.997026443	,	0.79855597	;
			-1.58751988	,	0.202617198	;
			1.68089974	,	-0.142544195	;
			-0.104660325	,	1.70304978	;
			-2.30029225	,	-0.475673407	;
			2.44481087	,	0.710400701	;
			-2.58491635	,	-0.861014366	;
			-0.816441655	,	-2.56479287	;
			2.6675117	,	0.887153149	;
			1.14876771	,	2.91041827	;
			2.91098404	,	1.12685132	;
			-2.91439748	,	-1.16017723	;
			-1.10790575	,	-2.89105034	;
			1.46862137	,	2.99606895	;
			2.01236439	,	3.0664618	;
			-3.07721496	,	-2.02077746	;
			-3.00301647	,	-1.47590363	;
			2.92269468	,	2.31022215	;
			-2.31339288	,	-2.93481088	;
			3.03224802	,	1.65215182	;
			-1.97512722	,	-3.08332753	;
			-1.42658281	,	-2.99242592	;
			-1.64885557	,	-3.04179835	;
			-2.82468462	,	-2.50154448	;
			2.30029416	,	2.9277606	;
			-2.93829417	,	-2.30964994	;
			3.07121992	,	1.97557795	;
			-2.65008163	,	-2.77332711	;
			2.49206924	,	2.81851387	;
			2.99340701	,	1.43404818	;
			-3.04629326	,	-1.69755149	;
			2.76027274	,	2.64441705	;
			1.69130766	,	3.03752089	;
			-0.152431831	,	-1.96787512	;
			0.700043678	,	-1.11997604	;
			1.09831274	,	-0.71298188	;
			0.46471411	,	-1.45898652	;
			0.891275704	,	-0.914041102	;
			0.096180454	,	-1.73008072	;
			1.44144738	,	-0.481312126	;
			-0.400082499	,	-2.31431675	;
			0.841900945	,	2.61457801	;
			2.20013022	,	0.3714059	;
			-1.73428941	,	-0.016618619	;
			-0.418282241	,	1.44481671	;
			-0.78770566	,	0.955678999	];


	
n_mat = old_n_mat;
c_mat = old_c_mat;

boundary=10;

% g: position index for matrix of essential nodes only
g=0;

% make essen_mat which will contain node coordiantes + names

for h = 1: length(old_c_mat)
i = old_c_mat(h,1);
j = old_c_mat(h,2);
k = old_c_mat(h,3);
    
    if old_n_mat(i,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(i,1),old_n_mat(i,2),i];
       n_mat(i,:)=100;    
    end
    
    if old_n_mat(j,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(j,1),old_n_mat(j,2),j]; 
       n_mat(j,:)=100;    
    end
  
    if old_n_mat(k,1) == boundary
       g=g+1;
       essen_mat(g,:) = [old_n_mat(k,1),old_n_mat(k,2),k];
       n_mat(k,:)=100;    
    end
end    



counter= 0;  % how many essential nodes there are
for n = 1: length(old_n_mat)
    if old_n_mat(n,1) == boundary
        counter= counter+1;
    end
end

% The essential matrix will have repeats so we need to get rid of them 
no_repeat_essen_mat = unique(essen_mat,'rows'); % essential nodes without reps. 3 columns

% how many essentials are within counter? which are the total numer of
% points that needs to be replaced

counter2=0;  % number of ess. nodes that do not to go anywhere
for n=1:counter
    if no_repeat_essen_mat(n,3)<= counter
    counter2=counter2+1;
    end
end


%no_repeat_essen_mat=sortrows(no_repeat_essen_mat,3);
%no_repeat_essen_mat


% some points do not to go anywhere. However, we already removed them. here
% we are putting them back.

%5.
o=1; %indexer to make  index_of_put_back_points matrix
%counter3=0;
index_of_put_back_points = zeros(1,1);
for n = 1:counter
    if no_repeat_essen_mat(n,3) <= counter
        %counter3=counter3+1;
        n_mat(no_repeat_essen_mat(n,3),:)= [no_repeat_essen_mat(n,1) , no_repeat_essen_mat(n,2)];
   
        index_of_put_back_points(o,1)=[no_repeat_essen_mat(n,3)];
        o=o+1;
    end
end


%6.
no_repeat_essen_mat(no_repeat_essen_mat(:,3)<= counter,:)= [];

% now, we will get rid of the node number from the eseential matrix. So
% that we can be left jsut with the coordinates of the nodes only

no_repeat_essen_mat_2col= no_repeat_essen_mat;
no_repeat_essen_mat_2col_index=no_repeat_essen_mat(:,3);
no_repeat_essen_mat_2col(:,3)=[];


% now, we have the essential matrix ready to be inputed into the node
% matrix in the first rows where there are not already essential nodes. However, before we do this, we will need to
% collect the first rows (not including essential nodes) and send them down to the previous positions of the
% essential nodes

% points_back: get the points from the beginning of the nodes, leave the empty spaces so
% that we can bring in the essential nodes forward

%7.
points_back_index = zeros(counter-counter2,1);
points_back_index;
index_of_put_back_points;

for n= 1 : counter
  
    points_back(n,:) = [n_mat(n,:)];
    points_back_index(n,1) = [n];
    
end


points_back(index_of_put_back_points,:)= [];
points_back_index(index_of_put_back_points,:)=[]  ;



for n = 1: counter-counter2
    n_mat(points_back_index(n,1),:) = no_repeat_essen_mat_2col(n,:);
end

for n = 1: counter-counter2
    n_mat(no_repeat_essen_mat_2col_index(n,1),:) = points_back(n,:);
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == points_back_index(m)
                c_mat(h,l) = c_mat(h,l)+1000;
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(no_repeat_essen_mat_2col_index)
            if c_mat(h,l) == no_repeat_essen_mat_2col_index(m)
                c_mat(h,l) = c_mat(h,l)+2000;
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == points_back_index(m)+1000
                c_mat(h,l) = no_repeat_essen_mat_2col_index(m);
            end
        end
    end
end

for h = 1: length(c_mat)
    for l =1:3
        for m = 1:length(points_back_index)
            if c_mat(h,l) == no_repeat_essen_mat_2col_index(m)+2000
                c_mat(h,l) =points_back_index(m);
            end
        end
    end
end
end
